<%# 通知メッセージの表示 %>
<% if notice %>
  <p class="max-w-4xl mx-auto text-green-600 font-medium mb-4 px-4"><%= notice %></p>
<% end %>


<div class="flex items-center h-14 px-4 bg-white/80 backdrop-blur-sm sticky top-0 z-10 border-b border-gray-100">
  <h1 class="ml-4 text-xl font-bold text-gray-900">書籍情報</h1>
</div>

<%# 
  Stimulusコントローラーを紐付け。
  コントローラー名が book_search_controller.js なら "book-search" に。
  apiKeyValue に Google Books の ID を渡す。
%>
<div class="max-w-4xl mx-auto bg-white shadow-sm border border-gray-100 rounded-2xl overflow-hidden mt-8"
     data-controller="book-loader"
     data-book-loader-api-key-value="<%= @book_id %>">
  
  <div class="md:flex">
    
    <%# 左側：書影エリア（thumbnail target） %>
    <div data-book-loader-target="thumbnail" 
         class="md:w-1/3 bg-gray-50 flex items-center justify-center p-8 border-b md:border-b-0 md:border-r border-gray-100 min-h-[350px]">
      <%# API取得前：スケルトン表示 %>
      <div class="animate-pulse bg-gray-200 w-48 h-72 rounded-lg shadow-md"></div>
    </div>

    <%# 右側：書籍情報エリア %>
    <div class="md:w-2/3 p-8 flex flex-col justify-between">
      <div>
        <%# タイトル (title target) %>
        <h1 data-book-loader-target="title" class="text-3xl font-extrabold text-gray-900 leading-tight mb-2">
          <span class="animate-pulse bg-gray-200 h-8 w-3/4 block rounded"></span>
        </h1>
        
        <%# 著者 (authors target) %>
        <p data-book-loader-target="authors" class="text-lg text-blue-600 font-medium mb-6">
          <span class="animate-pulse bg-gray-200 h-4 w-1/2 block rounded mt-2"></span>
        </p>

        <div class="prose prose-sm text-gray-600 max-w-none">
          <h2 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-2">書籍紹介</h2>
          <%# 説明文 (description target) %>
          <div data-book-loader-target="description" class="leading-relaxed whitespace-pre-wrap text-gray-700">
             <span class="animate-pulse bg-gray-200 h-4 w-full block rounded mb-2"></span>
             <span class="animate-pulse bg-gray-200 h-4 w-full block rounded mb-2"></span>
             <span class="animate-pulse bg-gray-200 h-4 w-2/3 block rounded"></span>
          </div>
        </div>
      </div>

      <%# 下部：アクションボタン %>
      <div class="mt-10 pt-6 border-t border-gray-100 flex flex-wrap items-center gap-4">

        <%# 一覧へ戻るボタン（右側） %>
        <div class="ml-auto">
          <%= button_to libraries_path(api_str: @book_id), 
              method: :post, 
              class: "inline-flex items-center px-5 py-2.5 bg-green-500 text-white text-sm font-bold rounded-xl hover:bg-green-600 transition shadow-sm" do %>
            ライブラリに追加
          <% end %>
        </div>

      </div>
    </div>
  </div>
</div>